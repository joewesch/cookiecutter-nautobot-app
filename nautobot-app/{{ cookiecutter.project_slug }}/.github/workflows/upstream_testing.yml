---
name: "Nautobot Upstream Monitor"

on:  # yamllint disable-line rule:truthy rule:comments
  schedule:
    - cron: "0 4 */2 * *"  # every other day at 4 AM
  workflow_dispatch:

jobs:
  upstream-test:
    strategy:
      fail-fast: false
      matrix:
        include:
          - nautobot_branch: "develop"
            app_branch: "main"
          - nautobot_branch: "next"
            app_branch: "main"
          - nautobot_branch: "ltm-2.4"
            app_branch: "ltm-2.4"
          # - nautobot_branch: "next-4.0"
          #   app_branch: "next-4.0"
    uses: "nautobot/nautobot/.github/workflows/plugin_upstream_testing_base.yml@develop"
    with:  # Below could potentially be collapsed into a single argument if a concrete relationship between both is enforced
      invoke_context_name: "{{ cookiecutter.app_name.upper() }}"
      app_name: "{{ cookiecutter.app_slug }}"
      nautobot_branch: "{% raw %}${{ matrix.nautobot_branch }}{% endraw %}"
      app_branch: "{% raw %}${{ matrix.app_branch }}{% endraw %}"
